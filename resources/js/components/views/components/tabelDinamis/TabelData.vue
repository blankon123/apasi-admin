<template>
  <v-card>
    Web Tabel
    <v-card-text class="ma-0 pa-0">
      <div id="example" class="black--text "></div>
    </v-card-text>
    <v-progress-linear
      indeterminate
      color="cyan"
      rounded
      v-if="loading"
    ></v-progress-linear>
    {{ tabelData }}
  </v-card>
</template>

<script>
export default {
  props: ["loading", "tabelData"],
  data: () => ({
    handsontableReady: false,
    checkingInterval: null
  }),
  created() {
    let localThis = this;
    this.checkingInterval = setInterval(function() {
      if (window.Handsontable) {
        localThis.handsontableReady = true;
      }
    }, 100);
  },
  watch: {
    handsontableReady(data) {
      if (data) {
        clearInterval(this.checkingInterval);
        this.init();
      }
    },
    tabelData() {
      this.init();
    }
  },
  mounted() {
    this.loadJSLibrary(
      "https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"
    );
    this.loadCSSLibrary(
      "https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css"
    );
  },
  methods: {
    init() {
      const container = document.getElementById("example");
      const hot = new window.Handsontable(container, {
        licenseKey: "non-commercial-and-evaluation",
        rowHeaders: true,
        colHeaders: true,
        width: "100%",
        height: "60vh",
        data: [
          [
            "",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford",
            "Tesla",
            "Volvo",
            "Toyota",
            "Ford"
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2019",
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13,
            10,
            11,
            12,
            13
          ],
          [
            "2020",
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13,
            20,
            11,
            14,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ],
          [
            "2021",
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13,
            30,
            15,
            12,
            13
          ]
        ]
      });
      //urutan Data -> vervar.var.turvar.tahun.turtahun
    },
    loadJSLibrary(url) {
      let scriptTag = document.createElement("script");
      scriptTag.setAttribute("src", url);
      document.head.appendChild(scriptTag);
    },
    loadCSSLibrary(url) {
      let styleTag = document.createElement("link");
      styleTag.setAttribute("rel", "stylesheet");
      styleTag.setAttribute("href", url);
      document.head.appendChild(styleTag);
    }
  }
};
</script>

<style></style>
